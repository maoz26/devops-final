FROM node:12-alpine
RUN apk add --no-cache python g++ make
WORKDIR /app
COPY . .

ENV APP_NAME = $APP_NAME
ENV APP_PORT = $APP_PORT
ENV MONGO_DB_ROOT_USERNAME = $MONGO_DB_ROOT_USERNAME
ENV MONGO_DB_ROOT_PASSWORD = $MONGO_DB_ROOT_PASSWORD
ENV MONGO_DB_DATABASE = $MONGO_DB_DATABASE
ENV MONGO_HOST_URL = $MONGO_HOST_URL

RUN yarn install --production
CMD ["node", "src/index.js"]